       >>SOURCE FORMAT FREE
IDENTIFICATION DIVISION.
PROGRAM-ID. HAMURABI.

DATA DIVISION.
       WORKING-STORAGE SECTION.
       01 ScratchPad.
          02 D1 PIC 9999 VALUE 0.
          02 P1 PIC 9999 VALUE 0.
          02 Z PIC 9999 VALUE 0.
          02 P PIC 9999 VALUE 95.
          02 S PIC 9999 VALUE 2800.
          02 H PIC 9999 VALUE 3000.
          02 E PIC 9999.
          02 Y PIC 9999 VALUE 3.
          02 A PIC 9999.
          02 I PIC 9999 VALUE 5.
          02 Q PIC 9999 VALUE 1.
          02 D PIC 9999 VALUE 0.
          02 L PIC 9999.
          02 X PIC 9999.
          02 DUMMY PIC 9999.
          02 C PIC 9999.
PROCEDURE DIVISION.
       CALL "RNGSEED"
       DISPLAY "HAMURABI"
       DISPLAY "CREATIVE COMPUTING, MORRISTOWN NEW JERSEY"
       DISPLAY "TRANSLATED INTO COBOL BY THEGRUMPYGAMEDEV"
       DISPLAY " "
       DISPLAY " "
       DISPLAY " "
       DISPLAY "TRY YER HAND AT GOVERNING ANCIENT SUMERIA"
       DISPLAY "FOR A TEN YEAR TERM OF OFFICE"
       MOVE H TO E
       SUBTRACT S FROM E    
       DIVIDE H BY Y GIVING A.

LINE210.
       MOVE 0 TO D.
LINE215.
       DISPLAY " "
       DISPLAY " "
       DISPLAY "HAMURABI:  I BEG TO REPORT TO YOU,"
       ADD 1 TO Z
       DISPLAY "IN YEAR " Z ", " D " PEOPLE STARVED, " I " CAME TO THE CITY,"
       ADD I TO P
       IF Q IS GREATER THAN 0 THEN
           GO TO LINE230
       END-IF
       DIVIDE P BY 2 GIVING P
       DISPLAY "A HORRIBLE PLAGUE STRUCK! HALF THE PEOPLE DIED.".

LINE230.
       DISPLAY "POPULATION IS NOW " P
       DISPLAY "THE CITY NOW OWNS " A " ACRES."
       DISPLAY "YOU HARVESTED " Y " BUSHELS PER ACRE."
       DISPLAY "RATES ATE " E " BUSHELS."
       DISPLAY "YOU NOW HAVE " S " maBUSHELS IN STORE."
       DISPLAY " "
       IF Z IS EQUAL TO 11 THEN
           GO TO LINE860
       END-IF
       MOVE 10 TO Y
       MULTIPLY FUNCTION RANDOM() BY Y
       ADD 17 TO Y
       DISPLAY "LAND IS TRADING AT " Y " BUSHELS PER ACRE.".

LINE320.
       DISPLAY "HOW MANY ACRES DO YOU WISH TO BUY? " WITH NO ADVANCING
       ACCEPT Q
       IF Q IS LESS THAN 0 THEN
           GO TO LINE850
       END-IF
       IF Y * Q IS LESS THAN S THEN
           GO TO LINE330
       END-IF
       PERFORM LINE710
       GO TO LINE320.

LINE330.
       IF Q IS EQUAL TO 0 THEN
           GO TO LINE340
       END-IF
       ADD Q TO A
       MULTIPLY Y BY Q
       SUBTRACT Q FROM S
       GO TO LINE400.

LINE340.
       DISPLAY "HOW MANY ACRES DO YOU WISH TO SELL? " WITH NO ADVANCING
       ACCEPT Q
       IF Q IS LESS THAN 0 THEN
           GO TO LINE850
       END-IF
       IF Q IS LESS THAN A THEN
           GO TO LINE350
       END-IF
       PERFORM LINE720
       GO TO LINE340.

LINE350.
       SUBTRACT Q FROM A
       MULTIPLY Y BY Q
       ADD Q TO S.
LINE400.
       DISPLAY " ".
LINE410.
       DISPLAY "HOW MANY BUSHELS DO YOU WISH TO FEED YER PEOPLE? " WITH NO ADVANCING
       ACCEPT Q
       IF Q IS LESS THAN 0 THEN
           GO TO LINE850
       IF Q IS LESS THAN S THEN
           GO TO LINE430
       PERFORM LINE710
       GO TO LINE410.

LINE430.
       SUBTRACT Q FROM S.
       DISPLAY " ".
LINE440.
       DISPLAY "HOW MANY ACRES DO YOU WITH TO PLANT WITH SEED? " WITH NO ADVANCING
       ACCEPT D
       IF D IS EQUAL TO 0 THEN 
           GO TO LINE511
       IF D IS LESS THAN 0 THEN GO TO LINE850
       IF D IS LESS THAN A THEN GO TO LINE450
       PERFORM LINE720
       GO TO LINE440.

LINE450.
       MOVE D TO DUMMY
       DIVIDE DUMMY BY 2 GIVING DUMMY
       IF DUMMY IS NOT GREATER THAN S THEN GO TO LINE455
       PERFORM LINE710
       GO TO LINE440.

LINE455.
       MOVE P TO DUMMY
       MULTIPLY 10 BY P
       IF D IS LESS THAN DUMMY THEN GO TO LINE510
       DISPLAY "BUT YOU HAVE ONLY " P " PEOPLE TO TEND THE FIELDS! NOW THEN, "
       GO TO LINE440.
LINE510.
       DIVIDE D BY 2 GIVING D
       SUBTRACT D FROM S.

LINE511.
       PERFORM LINE800.
       MOVE C TO Y
       MOVE Y TO H
       MULTIPLY D BY H
       MOVE 0 TO E
       PERFORM LINE800
       EVALUATE C
           WHEN 1
           WHEN 3
           WHEN 5
               GO TO LINE530
       END-EVALUATE.
       MOVE S TO E
       DIVIDE E BY C GIVING E.

LINE530.
       SUBTRACT E FROM S
       ADD H TO S
       PERFORM LINE800
       MOVE A TO I
       MULTIPLY 20 BY I
       ADD S TO I
       MULTIPLY C BY I
       DIVIDE I BY P GIVING I
       DIVIDE I BY 100 GIVING I
       ADD 1 TO I
       DIVIDE Q BY 20 GIVING C
       COMPUTE Q = 10 * (2 * FUNCTION RANDOM - 0.3)
       IF P IS LESS THAN C THEN GO TO LINE210
       MOVE P TO D
       SUBTRACT C FROM D
       MOVE P TO DUMMY
       MULTIPLY 45 BY DUMMY
       DIVIDE DUMMY BY 100 GIVING DUMMY
       IF D IS GREATER THAN DUMMY THEN GO TO LINE560
       COMPUTE P1 = ((Z - 1) * P1 + D * 100 / P) / Z
       MOVE C TO P
       ADD D TO D1
       GO TO LINE215.

LINE560.
       DISPLAY "YOU STARVED " D " PEOPLE IN ONE YEAR!!!".
LINE565.
       DISPLAY "DUE TO THIS EXTREME MISMANAGEMENT YOU HAVE NOT ONLY"
       DISPLAY "BEEN IMPEACHED AND THROWN OUT OF OFFICE BUT YOU HAVE"
       DISPLAY "ALSO BEEN DECLARED NATIONAL FINK!!!!"
       GO TO LINE990.

LINE710.
       DISPLAY "HAMURABI:  THINK AGAIN. YOU HAVE ONLY"
       DISPLAY S " BUSHELS OF GRAIN. NOW THEN,"
       EXIT.

LINE720.
       DISPLAY "HAMURABI:  THINK AGAING. YOU OWN ONLY " A " ACRES. NOW THEN, "
       EXIT.

LINE800.
       COMPUTE C = FUNCTION RANDOM * 5 + 1
       EXIT.

LINE850.
       DISPLAY " "
       DISPLAY "HAMURABI:  I CANNOT DO WHAT YOU WISH."
       DISPLAY "GET YERSELF ANOTHER STEWARD!!!!"
       GO TO LINE990.

LINE860.
       DISPLAY "IN YER 10-YEAR TERM OFF OFFICE, " P1 " PERCENT OF THE"
       DISPLAY "POPULATION STARVED PER YEAR ON THE AVERAGE, I.E. A TOTAL OF"
       DISPLAY D1 " PEOPLE DIED!!"
       DIVIDE A BY P GIVING L
       DISPLAY "YOU STARTED WITH 10 ACRES PER PERSON AND ENDED WITH"
       DISPLAY L " ACRES PER PERSON."
       DISPLAY " "
       IF P1 IS GREATER THAN 33 OR L IS LESS THAN 7 THEN
           GO TO LINE565
       END-IF
       IF P1 IS GREATER THAN 10 OR L IS LESS THAN 9 THEN
           GO TO LINE940
       END-IF
       IF P1 IS GREATER THAN 3 OR L IS LESS THAN 10 then 
           GO TO LINE960
       END-IF
       DISPLAY "FANTASTIC PERFORMANCE!!!  CHARLEMAGNE, DISRAELI, AND"
       DISPLAY "JEFFERSON COMBINED COULD NOT HAVE DONE BETTER!"
       GO TO LINE990.

LINE940.
       DISPLAY "YER HEAVY-HANDED PERFORMANCE SMACKS OF NERO AND IVAN IV."
       DISPLAY "THE PEOPLE (REMAINING) FIND YOU AN UNPLEASANT RULER, AND,"
       DISPLAY "FRANKLY, HATE YER GUTS!!"
       GO TO LINE990.
       
LINE960.
       DISPLAY "YER PERFORMANCE COULD HAVE BEEN SOMEWHAT BETTER, BUT"
       MOVE P TO X
       MULTIPLY 8 BY X
       DIVIDE X BY 10 GIVING X
       MULTIPLY FUNCTION RANDOM() BY X
       DISPLAY "REALLY WASN'T TOO BAD AT ALL." X "PEOPLE"
       DISPLAY "DEARLY LIKE TO SEE YOU ASSASSINATED BY WE ALL HAVE OUR"
       DISPLAY "TRIVIAL PROBLEMS.".

LINE990.
       DISPLAY "SO LONG FOR NOW."
       DISPLAY " "
       STOP RUN.
