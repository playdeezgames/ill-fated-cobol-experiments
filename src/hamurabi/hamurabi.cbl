       >>SOURCE FORMAT FREE
IDENTIFICATION DIVISION.
PROGRAM-ID. HAMURABI.

DATA DIVISION.
       WORKING-STORAGE SECTION.
       01 ScratchPad.
          02 D1 PIC 9999 VALUE 0.
          02 P1 PIC 9999 VALUE 0.
          02 Z PIC 9999 VALUE 0.
          02 P PIC 9999 VALUE 95.
          02 S PIC 9999 VALUE 2800.
          02 H PIC 9999 VALUE 3000.
          02 E PIC 9999.
          02 Y PIC 9999 VALUE 3.
          02 A PIC 9999.
          02 I PIC 9999 VALUE 5.
          02 Q PIC 9999 VALUE 1.
          02 D PIC 9999 VALUE 0.
          02 L PIC 9999.
          02 X PIC 9999.
PROCEDURE DIVISION.
       CALL "RNGSEED"
       DISPLAY "HAMURABI"
       DISPLAY "CREATIVE COMPUTING, MORRISTOWN NEW JERSEY"
       DISPLAY "TRANSLATED INTO COBOL BY THEGRUMPYGAMEDEV"
       DISPLAY " "
       DISPLAY " "
       DISPLAY " "
       DISPLAY "TRY YER HAND AT GOVERNING ANCIENT SUMERIA"
       DISPLAY "FOR A TEN YEAR TERM OF OFFICE"
       MOVE H TO E
       SUBTRACT S FROM E    
       DIVIDE H BY Y GIVING A.

LINE215.
       DISPLAY " "
       DISPLAY " "
       DISPLAY "HAMURABI:  I BEG TO REPORT TO YOU,"
       ADD 1 TO Z
       DISPLAY "IN YEAR " Z ", " D " PEOPLE STARVED, " I " CAME TO THE CITY,"
       ADD I TO P
       IF Q IS GREATER THAN 0 THEN
           GO TO LINE230
       END-IF
       DIVIDE P BY 2 GIVING P
       DISPLAY "A HORRIBLE PLAGUE STRUCK! HALF THE PEOPLE DIED.".

LINE230.
       DISPLAY "POPULATION IS NOW " P
       DISPLAY "THE CITY NOW OWNS " A " ACRES."
       DISPLAY "YOU HARVESTED " Y " BUSHELS PER ACRE."
       DISPLAY "RATES ATE " E " BUSHELS."
       DISPLAY "YOU NOW HAVE " S "BUSHELS IN STORE."
       DISPLAY " "
       IF Z IS EQUAL TO 11 THEN
           GO TO LINE860
       END-IF
       MOVE 10 TO Y
       MULTIPLY FUNCTION RANDOM() BY Y
       ADD 17 TO Y
       DISPLAY "LAND IS TRADING AT " Y " BUSHELS PER ACRE.".

LINE320.
       DISPLAY "HOW MANY ACRES DO YOU WISH TO BUY? " WITH NO ADVANCING
       ACCEPT Q
       IF Q IS LESS THAN 0 THEN
           GO TO LINE850
       END-IF
       IF Y * Q IS LESS THAN S THEN
           GO TO LINE330
       END-IF
       PERFORM LINE710
       GO TO LINE320.

LINE330.
       IF Q IS EQUAL TO 0 THEN
           GO TO LINE340
       END-IF
       ADD Q TO A
       MULTIPLY Y BY Q
       SUBTRACT Q FROM S
       GO TO LINE400.

LINE340.
       DISPLAY "HOW MANY ACRES DO YOU WISH TO SELL" WITH NO ADVANCING
       ACCEPT Q
       IF Q IS LESS THAN 0 THEN
           GO TO LINE850
       END-IF
       IF Q IS LESS THAN A THEN
           GO TO LINE350
       END-IF
       PERFORM LINE720
       GO TO LINE340.

LINE350.
       SUBTRACT Q FROM A
       MULTIPLY Y BY Q
       ADD Q TO S.
LINE400.
       DISPLAY " ".
LINE410.
       DISPLAY "HOW MANY BUSHELS DO YOU WISH TO FEED YER PEOPLE? " WITH NO ADVANCING
       ACCEPT Q
       IF Q IS LESS THAN 0 THEN
           GO TO LINE850
       END-IF
       IF Q IS LESS THAN S THEN
           GO TO LINE430
       END-IF
       PERFORM LINE710
       GO TO LINE410.

LINE430.
       SUBTRACT Q FROM S
*> CONTINUE FROM HERE, YER ON LINE 440

LINE565.
       DISPLAY "DUE TO THIS EXTREME MISMANAGEMENT YOU HAVE NOT ONLY"
       DISPLAY "BEEN IMPEACHED AND THROWN OUT OF OFFICE BUT YOU HAVE"
       DISPLAY "ALSO BEEN DECLARED NATIONAL FINK!!!!"
       GO TO LINE990.

LINE710.
       DISPLAY "HAMURABI:  THINK AGAIN. YOU HAVE ONLY"
       DISPLAY S " BUSHELS OF GRAIN. NOW THEN,"
       EXIT.

LINE720.
       DISPLAY "HAMURABI:  THINK AGAING. YOU OWN ONLY " A " ACRES. NOW THEN, "
       EXIT.

LINE850.
       DISPLAY " "
       DISPLAY "HAMURABI:  I CANNOT DO WHAT YOU WISH."
       DISPLAY "GET YERSELF ANOTHER STEWARD!!!!"
       GO TO LINE990.

LINE860.
       DISPLAY "IN YER 10-YEAR TERM OFF OFFICE, " P1 " PERCENT OF THE"
       DISPLAY "POPULATION STARVED PER YEAR ON THE AVERAGE, I.E. A TOTAL OF"
       DISPLAY D1 " PEOPLE DIED!!"
       DIVIDE A BY P GIVING L
       DISPLAY "YOU STARTED WITH 10 ACRES PER PERSON AND ENDED WITH"
       DISPLAY L " ACRES PER PERSON."
       DISPLAY " "
       IF P1 IS GREATER THAN 33 OR L IS LESS THAN 7 THEN
           GO TO LINE565
       END-IF
       IF P1 IS GREATER THAN 10 OR L IS LESS THAN 9 THEN
           GO TO LINE940
       END-IF
       IF P1 IS GREATER THAN 3 OR L IS LESS THAN 10 then 
           GO TO LINE960
       END-IF
       DISPLAY "FANTASTIC PERFORMANCE!!!  CHARLEMAGNE, DISRAELI, AND"
       DISPLAY "JEFFERSON COMBINED COULD NOT HAVE DONE BETTER!"
       GO TO LINE990.

LINE940.
       DISPLAY "YER HEAVY-HANDED PERFORMANCE SMACKS OF NERO AND IVAN IV."
       DISPLAY "THE PEOPLE (REMAINING) FIND YOU AN UNPLEASANT RULER, AND,"
       DISPLAY "FRANKLY, HATE YER GUTS!!"
       GO TO LINE990.
       
LINE960.
       DISPLAY "YER PERFORMANCE COULD HAVE BEEN SOMEWHAT BETTER, BUT"
       MOVE P TO X
       MULTIPLY 8 BY X
       DIVIDE X BY 10 GIVING X
       MULTIPLY FUNCTION RANDOM() BY X
       DISPLAY "REALLY WASN'T TOO BAD AT ALL." X "PEOPLE"
       DISPLAY "DEARLY LIKE TO SEE YOU ASSASSINATED BY WE ALL HAVE OUR"
       DISPLAY "TRIVIAL PROBLEMS.".

LINE990.
       DISPLAY "SO LONG FOR NOW."
       DISPLAY " "
       STOP RUN.
